#include <SPI.h>
#include <DMD.h>
#include <TimerOne.h>
#include "SystemFont5x7.h"

#define DISPLAYS_ACROSS 1
#define DISPLAYS_DOWN 1

DMD dmd(DISPLAYS_ACROSS, DISPLAYS_DOWN);

void ScanDMD() {
  dmd.scanDisplayBySPI();
}

char teks[] =
"TEMANKU SEMUA PADA JAHAT TANTE "
"AKU LAGI SUSAH MEREKA GAK ADA "
"COBA KALO LAGI JAYA "
"AKU DIPUJA PUJANYA TANTE "
"SUDAH TERBIASA TERJADI TANTE "
"TEMAN DATANG KETIKA LAGI BUTUH SAJA "
"COBA KALO LAGI SUSAH "
"MEREKA SEMUA MENGHILANG   ";

int pos = 0; // posisi marquee

void setup() {
  Timer1.initialize(1000);  
  Timer1.attachInterrupt(ScanDMD);

  dmd.clearScreen(true);
  dmd.selectFont(SystemFont5x7);
}

void loop() {
  // Kecepatan scroll (atur lebih kecil lebih cepat)
  const int scrollDelay = 100;

  // Gambar teks dua kali dengan offset kecil agar terlihat "tebal"
  dmd.drawMarquee(teks, strlen(teks), (32 * DISPLAYS_ACROSS) - pos, 0);
  dmd.drawMarquee(teks, strlen(teks), (32 * DISPLAYS_ACROSS) - pos - 1, 0);

  long start = millis();
  while (millis() - start < scrollDelay) {
    // stepMarquee menggerakkan teks
    if (dmd.stepMarquee(-1, 0)) {
      // jika teks telah selesai scroll habis
      pos = 0; // reset supaya loop restart dari awal
      break;
    }
  }
  pos++;
}
